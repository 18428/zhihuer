{% extends 'user/user_base.html' %}

{% block user_content %}

{% load myfilter %}
<h4>{% if user == request.user %}我的动态{% else %}他的动态{% endif %}</h4>
<hr>
{% for obj in user_trend_sorted_page.object_list %}

<!-- 回答了问题 -->
{% if obj|object_class_name == 'Answer' %}
<div class="trend-item">
  <p class="text-muted">回答了问题<span class="right-info">{{ obj.pub_time|date:"Y年m月d日" }}</span></p>
  <a href="{% url 'question_detail' obj.question_id %}"><h3>{{ obj.question.title }}</h3></a>
  <div class="media">
    <a href="{% url 'user_home' obj.question.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
    <div class="media-body">
      <p class="media-heading">{{ obj.author.nickname }}</p>
    </div>
  </div>
  <p class="text-muted">{{ obj.get_follow_nums }} 人赞同了该回答</p>
  <p class="answer-content"><a href="{% url 'answer_detail' obj.id %}">{{ obj.content|striptags|truncatechars:200 }}</a></p>
  <div class="answer-meta">
    <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-primary btnvote-up btn-sm"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.get_follow_nums }}</button></a>
    <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default btnvote-down btn-sm"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
    <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default btn-sm">{{ obj.get_comment_nums }} 条评论</button></a>
    <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
  </div>
</div>
<hr>
<!-- 添加了问题 -->
{% elif obj|object_class_name == 'Question' %}
<div class="trend-item">
  <p class="text-muted">添加了问题<span class="right-info">{{ obj.pub_time|date:"Y年m月d日" }}</span></p>
  <a href="{% url 'question_detail' obj.id %}"><h3>{{ obj.title }}</h3></a>
</div>
<hr>
<!-- 赞同了回答 -->
{% elif obj|object_class_name == 'UserFollowAnswer' %}
<div class="trend-item">
  <p class="text-muted">赞同了回答<span class="right-info">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
  <a href="{% url 'question_detail' obj.answer.question_id %}"><h3>{{ obj.answer.question.title }}</h3></a>
  <div class="media">
    <a href="{% url 'user_home' obj.answer.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
    <div class="media-body">
      <p class="media-heading">{{ obj.answer.author.nickname }}</p>
    </div>
  </div>
  <p class="text-muted">{{ obj.answer.get_follow_nums }} 人赞同了该回答</p>
  <p class="answer-content"><a href="{% url 'answer_detail' obj.answer_id %}">{{ obj.answer.content|striptags|truncatechars:200 }}</a></p>
  <div class="answer-meta">
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-primary btnvote-up btn-sm"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.answer.get_follow_nums }}</button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btnvote-down btn-sm"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btn-sm">{{ obj.answer.get_comment_nums }} 条评论</button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
  </div>
</div>
<hr>
<!-- 收藏了回答 -->
{% elif obj|object_class_name == 'UserCollectAnswer' %}
<div class="trend-item">
  <p class="text-muted">在 {{ obj.answer.question.get_topic_name }} 中收藏了回答<span class="right-info">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
  <a href="{% url 'question_detail' obj.answer.question_id %}"><h3>{{ obj.answer.question.title }}</h3></a>
  <div class="media">
    <a href="{% url 'user_home' obj.answer.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
    <div class="media-body">
      <p class="media-heading">{{ obj.answer.author.nickname }}</p>
    </div>
  </div>
  <p class="text-muted">{{ obj.answer.get_follow_nums }} 人赞同了该回答</p>
  <p class="answer-content"><a href="{% url 'answer_detail' obj.answer_id %}">{{ obj.answer.content|striptags|truncatechars:200 }}</a></p>
  <div class="answer-meta">
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-primary btnvote-up btn-sm"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.answer.get_follow_nums }}</button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btnvote-down btn-sm"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btn-sm">{{ obj.answer.get_comment_nums }} 条评论</button></a>
    <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
  </div>
</div>
<hr>
<!-- 关注了问题 -->
{% elif obj|object_class_name == 'UserFollowQuestion' %}
<div class="trend-item">
  <p class="text-muted">关注了问题<span class="right-info">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
  <a href="{% url 'question_detail' obj.question_id %}"><h3>{{ obj.question.title }}</h3></a>
</div>
<hr>
{% endif %}
{% endfor %}
{% include 'zhihu/paginator.html' with page=user_trend_sorted_page %}

{% endblock %}