{% extends 'base.html' %}

{% block title %}{{ user.nickname }}的主页-知乎儿{% endblock %}

{% block content %}

{% load myfilter %}
<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <div class="site-box">
        <div class="media">
          <div class="media-left"><img src="" alt="头像" class="media-left"></div>
          <div class="media-body">
            <h3 class="media-heading"><strong>{{ user.nickname }}</strong></h3>
            <p><strong>{{ user.description }}</strong></p>
            {% if user == request.user %}
            <div class="pull-right"><a href="">编辑个人资料</a></div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-8">
      <div class="site-box">
        <div class="nav nav-pills">
          <li class="active"><a href="">动态</a></li>
          <li><a href="">回答</a></li>
          <li><a href="">提问</a></li>
          <li><a href="">想法</a></li>
        </div>
        <hr>
        <h4>我的动态</h4>
        <hr>
        {% for obj in user_trend_sorted_page.object_list %}

        <!-- 回答了问题 -->
        {% if obj|object_class_name == 'Answer' %}
        <div class="trend-item">
          <p class="text-muted">回答了问题<span class="time-right">{{ obj.pub_time|date:"Y年m月d日" }}</span></p>
          <h3>{{ obj.question.title }}</h3>
          <div class="media">
            <a href="{% url 'user_home' obj.question.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
            <div class="media-body">
              <p class="media-heading">{{ obj.author.nickname }}</p>
            </div>
          </div>
          <p class="text-muted">{{ obj.get_follow_nums }} 人赞同了该回答</p>
          <p class="answer-content"><a href="{% url 'answer_detail' obj.id %}">{{ obj.content|truncatechars:200 }}</a></p>
          <div class="answer-meta">
            <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-primary btnvote-up"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.get_follow_nums }}</button></a>
            <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default btnvote-down"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
            <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default">{{ obj.get_comment_nums }} 条评论</button></a>
            <a href="{% url 'answer_detail' obj.id %}"><button type="button" class="btn btn-default"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
          </div>
        </div>
        <hr>
        <!-- 添加了问题 -->
        {% elif obj|object_class_name == 'Question' %}
        <div class="trend-item">
          <p class="text-muted">添加了问题<span class="time-right">{{ obj.pub_time|date:"Y年m月d日" }}</span></p>
          <h3><a href="{% url 'question_detail' obj.id %}">{{ obj.title }}</a></h3>
        </div>
        <hr>
        <!-- 赞同了回答 -->
        {% elif obj|object_class_name == 'UserFollowAnswer' %}
        <div class="trend-item">
          <p class="text-muted">赞同了回答<span class="time-right">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
          <h3>{{ obj.answer.question.title }}</h3>
          <div class="media">
            <a href="{% url 'user_home' obj.answer.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
            <div class="media-body">
              <p class="media-heading">{{ obj.answer.author.nickname }}</p>
            </div>
          </div>
          <p class="text-muted">{{ obj.answer.get_follow_nums }} 人赞同了该回答</p>
          <p class="answer-content"><a href="{% url 'answer_detail' obj.answer_id %}">{{ obj.answer.content|truncatechars:200 }}</a></p>
          <div class="answer-meta">
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-primary btnvote-up"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.answer.get_follow_nums }}</button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btnvote-down"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default">{{ obj.answer.get_comment_nums }} 条评论</button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
            <span>{{ obj.answer.pub_time }}</span>
          </div>
        </div>
        <hr>
        <!-- 收藏了回答 -->
        {% elif obj|object_class_name == 'UserCollectAnswer' %}
        <div class="trend-item">
          <p class="text-muted">在 {{ obj.answer.question.get_topic_name }} 中收藏了回答<span class="time-right">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
          <h3>{{ obj.answer.question.title }}</h3>
          <div class="media">
            <a href="{% url 'user_home' obj.answer.author_id %}" class="media-left"><img src="" alt="头像" class="media-object"></a>
            <div class="media-body">
              <p class="media-heading">{{ obj.answer.author.nickname }}</p>
            </div>
          </div>
          <p class="text-muted">{{ obj.answer.get_follow_nums }} 人赞同了该回答</p>
          <p class="answer-content"><a href="{% url 'answer_detail' obj.answer_id %}">{{ obj.answer.content|truncatechars:200 }}</a></p>
          <div class="answer-meta">
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-primary btnvote-up"><span class="glyphicon glyphicon-triangle-top"></span> {{ obj.answer.get_follow_nums }}</button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default btnvote-down"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default">{{ obj.answer.get_comment_nums }} 条评论</button></a>
            <a href="{% url 'answer_detail' obj.answer_id %}"><button type="button" class="btn btn-default"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
            <span>{{ obj.answer.pub_time }}</span>
          </div>
        </div>
        <hr>
        <!-- 关注了问题 -->
        {% elif obj|object_class_name == 'UserFollowQuestion' %}
        <div class="trend-item">
          <p class="text-muted">关注了问题<span class="time-right">{{ obj.add_time|date:"Y年m月d日" }}</span></p>
          <h3><a href="{% url 'question_detail' obj.question_id %}">{{ obj.question.title }}</a></h3>
        </div>
        <hr>
        {% endif %}
        {% endfor %}
        {% include 'zhihu/paginator.html' with page=user_trend_sorted_page %}
      </div>
    </div>

    <div class="col-sm-4">
      <div class="site-box">
        <h4>个人成就</h4>
        <hr>
        <p><span class="glyphicon glyphicon-thumbs-up"></span> 获得 {{ user.get_answer_by_followed_nums }} 次赞同</p>
        <p><span class="glyphicon glyphicon-star"></span> 获得 {{ user.get_answer_by_collected_nums }} 次收藏</p>
      </div>
      <div class="site-box">
        <div class="nav nav-pills nav-stacked">
          <li><a href=""><span class="badge pull-right">12</span>关注了</a></li>
          <li><a href=""><span class="badge pull-right">15</span>关注者</a></li>
        </div>
      </div>
      <div class="site-box">
        <div class="nav nav-pills nav-stacked">
          <li><a href=""><span class="badge pull-right">37</span>关注的话题</a></li>
          <li><a href=""><span class="badge pull-right">35</span>关注的问题</a></li>
        </div>
      </div>
    </div>
  </div>
</div>


{% endblock %}