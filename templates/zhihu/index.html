{% extends 'base.html' %}

{% block title %}知乎儿{% endblock %}

{% block content %}

<div class="container">
  {% if messages %}
  <div class="messages">
    {% for message in messages %}
    <p class="alert alert-info alert-dismissable">
      <button class="close" type="button" data-dismiss="alert">&times;</button>{{ message }}</p>
    {% endfor %}
  </div>
  {% endif %}
  <div class="row">
    <div class="col-sm-8">
      <div class="header-box">
      <div class="container">
        <ul class="nav navbar-nav">
          <li><a href="{% url 'ask_question' %}" target="_blank">提问</a></li>
          <li><a href="">回答</a></li>
          <li><a href="">写文章</a></li>
          <li><a href="">写想法</a></li>
        </ul>
      </div>
      </div>

      {% for answer in page.object_list %}
          <div class="answer-item site-box">
            <p class="text-muted">来自话题:{{ answer.question.get_topic_name }}</p>
            <div class="media">
              <a href="" class="media-left"><img width="24px" src="{{ MEDIA_URL }}{{ answer.author.image }}" alt="头像" class="media-object"></a>
              <div class="media-body">
                <h4 class="media-heading">{{ answer.author.nickname }}<small>, {{ answer.author.description }}</small></h4>
              </div>
            </div>
            <div class="question-title">
                <a href="{% url 'question_detail' answer.question_id %}"><h3>{{ answer.question.title }}</h3></a>
            </div>
            <div class="answer-content">
                <a href="{% url 'answer_detail' answer.id %}"><p>{{ answer.content|truncatechars:200|safe }}</p></a>
            </div>
            <div class="answer-meta">
              <a href="{% url 'answer_detail' answer.id %}"<button type="button" class="btn btn-primary btnvote-up"><span class="glyphicon glyphicon-triangle-top"></span> {{ answer.follow_nums }}</button></a>
              <a href="{% url 'answer_detail' answer.id %}"<button type="button" class="btn btn-default btnvote-down"><span class="glyphicon glyphicon-triangle-bottom"></span></button></a>
              <a href="{% url 'answer_detail' answer.id %}"><button type="button" class="btn btn-default">{{ answer.comment_nums }} 条评论</button></a>
              <a href="{% url 'answer_detail' answer.id %}"<button type="button" class="btn btn-default"><span class="glyphicon glyphicon-star"></span>收藏</button></a>
              <span>{{ answer.pub_time }}</span>        
            </div>
            
          </div>
      {% empty %}
      <p>没有问答</p>
      {% endfor %}

      {% include 'zhihu/paginator.html' %}

    </div>

    <div class="col-sm-4">

    {% if request.user.is_authenticated %}
    <div class="site-box">
      {% if request.user.is_authenticated and request.user.confirmed == False %}
      <p>你的账户还没确认, 请前往邮箱确认.</p>
      <p>没收到确认邮件, 点击 <a class="send-email" href="{% url 'resend_confirm_email' %}">重新发送</a></p>
      {% endif %}
      <div class="media">
          <div class="media-left">
              <img src="" alt="头像" class="media-object">
          </div>
          <div class="media-body">
              <h4 class="media-heading">{{ request.user.nickname }}</h4>
              <p>{{ request.user.description }}</p>
          </div>
      </div>
      <hr>
      <div class="">
        <ul class="nav nav-stacked">
        <li><a href=""><span class="badge pull-right">{{ request.user.get_collect_answer_nums }}</span><b>我的收藏</b></a></li>
        <li><a href=""><span class="badge pull-right">{{ request.user.get_follow_question_nums }}</span><b>我关注的问题</b></a></li>
        </ul>
        </div>
      </div>
    {% else %}
    <div class="site-box right-block">
      <h4>加入知乎儿, 留下手印</h4>
      <p>
        <a target="_blank" href="{% url 'register' %}"><button class="btn btn-primary btn-lg btn-block">注册</button></a>
        <a target="_blank" href="{% url 'user_login' %}"><button class="btn btn-default btn-lg btn-block">登录</button></a>
      </p>
    </div>
    {% endif %}

    </div>

  </div>
</div>

<!--模态框-->
<div class="modal fade" id="question-submit" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" data-dismiss="modal">&times;</button>
        <h4 class="modal-title" id="question-label">写下你的问题</h4>
        <p class="text-muted">描述精确的问题更易得到解答</p>
      </div>
      <div class="modal-body">
        <form action="">
          {% csrf_token %}
          <input type="text" name="title" palceholder="写下你的问题">
          <input type="submit" value="提交问题">
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" data-dismiss="modal">关闭</button>
        <button class="btn btn-primary">提交问题</button>
      </div>
    </div>
  </div>
</div>


{% endblock %}